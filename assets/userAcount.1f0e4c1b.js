import{l as N,u as V,a as F,r as s,b as O,o as B,c as u,d as r,e,f as v,w as J,F as $,g as j,h as z,_ as E,i as G,j as q,t as g,k as w,v as U,m as T}from"./index.9e04de1e.js";const H={class:"userAcount position-relative"},K={class:"searchResult"},Q=e("h4",{class:"mt-0"},"\u5E33\u865F\u7BA1\u7406",-1),W={class:"searchResult-content"},X={class:"Result"},Z={class:"table table-hover m-0"},ee=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"\u5E33\u865F"),e("th",null,"\u67E5\u8A62"),e("th",null,"\u7BA1\u7406"),e("th",null,"\u4FEE\u6539\u4EBA\u54E1"),e("th",null,"\u4E0A\u6B21\u4FEE\u6539\u6642\u9593")])],-1),te={key:0},ae=["onUpdate:modelValue","checked","disabled"],oe=["onUpdate:modelValue","checked","disabled"],se={style:{width:"150px"}},ne={style:{width:"150px"}},le={class:"d-flex justify-content-end"},ce={key:0},ue={key:1,style:{width:"20px",height:"20px"},class:"spinner-border text-light",role:"status"},re=e("span",{class:"sr-only"},null,-1),de=[re],P=20,_e={__name:"userAcount",setup(ie){const Y=N(),S=V(),b=F.get("ECBO_role"),d=s(1),D=s(0),m=s(0),i=s([]),t=s([]),_=s(!1),n=O(),A=s(!1),C=s(b);s("/System/AccountRole");const I={State:0,Data:{Data:[{Id:1,Account:"user1",Role:["Read"],Updator:"admin",UpdateTime:"2023-07-16T10:00:00"},{Id:2,Account:"user2",Role:["Admin"],Updator:"admin",UpdateTime:"2023-07-16T11:00:00"}],PageCount:1,TotalCount:2}},x={State:0,Msg:"\u6210\u529F"};B(()=>{t.value.length==0&&(n.IsLoading=!0,f()),typeof b>"u"&&Y.userLogout()});const k=o=>C.value.includes("SuperAdmin")||C.value.includes("Admin")&&o==="Read",L=(o,a)=>o.filter(h=>{const p=a.find(y=>y.Account===h.Account);return p&&JSON.stringify(h.Role)!==JSON.stringify(p.Role)}),f=async o=>{try{typeof o!="number"?o=d.value:d.value=o;const a=I;a.State===0&&(i.value=a.Data.Data,D.value=a.Data.PageCount,m.value=a.Data.TotalCount,t.value=JSON.parse(JSON.stringify(i.value))),A.value=!0,n.IsLoading=!1}catch(a){console.error(a),n.IsLoading=!1}},M=async()=>{_.value=!0;try{if(L(t.value,i.value).length==0){_.value=!1;return}x.State===0&&(A.value=!0,_.value=!1,n.IsLoading=!1,n.ShowAlertText="\u5DF2\u5132\u5B58",n.ShowAlertIcon="bi-check-circle",n.ShowAlert=!0,f(),setTimeout(()=>{n.ShowAlert=!1},1e3))}catch(o){console.error(o)}};return(o,a)=>{const h=E,p=G,y=q;return u(),r("div",H,[e("div",K,[Q,e("div",W,[e("div",X,[v(h,{class:"mt-0",currentPage:d.value,pageSize:P,searchedData:i.value,totalCount:m.value},null,8,["currentPage","searchedData","totalCount"]),v(p,null,{default:J(()=>[e("table",Z,[ee,t.value.length>0?(u(),r("tbody",te,[(u(!0),r($,null,j(t.value,(c,l)=>(u(),r("tr",{key:c.Id,class:""},[e("td",null,g(l+1),1),e("td",null,g(c.Account+"@55688.com.tw"),1),e("td",null,[w(e("input",{type:"checkbox",value:"Read","onUpdate:modelValue":R=>t.value[l].Role=R,checked:t.value[l].Role.includes("Read"),disabled:!k("Read")},null,8,ae),[[U,t.value[l].Role]])]),e("td",null,[w(e("input",{type:"checkbox",value:"Admin","onUpdate:modelValue":R=>t.value[l].Role=R,checked:t.value[l].Role.includes("SuperAdmin")||t.value[l].Role.includes("Admin"),disabled:!k("Admin")},null,8,oe),[[U,t.value[l].Role]])]),e("td",se,g(c.Updator?c.Updator:"--"),1),e("td",ne,g(T(S).formatDateToYYYYMMDD(c.UpdateTime)?T(S).formatDateToYYYYMMDD(c.UpdateTime):"--"),1)]))),128))])):z("",!0)])]),_:1}),v(h,{currentPage:d.value,pageSize:P,searchedData:i.value,totalCount:m.value},null,8,["currentPage","searchedData","totalCount"]),e("div",le,[e("button",{type:"submit",onClick:a[0]||(a[0]=c=>M()),class:"btn btn-primary mediumbtn d-flex justify-content-center align-items-center"},[_.value?(u(),r("div",ue,de)):(u(),r("span",ce,"\u5132\u5B58"))])]),e("div",null,[v(y,{searchFun:f,currentPage:d.value,pageCount:D.value},null,8,["currentPage","pageCount"])])])])])])}}};export{_e as default};
