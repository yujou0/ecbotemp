import{_ as ee}from"./searchResult.9bf5ef40.js";import{u as te,a as ae,_ as se,b as re,c as ne}from"./globalFunctions.6c536278.js";import{_ as oe}from"./SearchBtn.e8dd1aed.js";import{_ as le}from"./SelectThreeGroupBox.fa2fa838.js";import{_ as ue}from"./InputTwoGroupBox.b2d0888b.js";import{r as d,b as de,D as Y,o as ie,C as ce,c as i,d as c,e as a,E as he,f as v,w as G,i as ve,G as Se,F as C,g as O,n as N,t as u,h as B,u as p,L as De}from"./index.acd8174a.js";/* empty css             */import{_ as pe}from"./CustomDatePicker.vue_vue_type_script_setup_true_lang.2a23c29c.js";const me={class:"orderSearch"},fe={class:"searchSetion"},ge={class:"d-flex"},_e={class:"d-flex col-6"},ye={class:"col-6"},Pe=a("p",{class:"advancedTitle"},"\u9032\u968E\u641C\u5C0B\u689D\u4EF6",-1),be={class:"d-flex"},Ie={class:"d-flex w-100 justify-content-between"},Ce={class:"advancedTitle-content d-flex align-items-center"},Oe={class:"Result"},Ne={class:"table table-hover m-0"},Re=a("thead",null,[a("tr",null,[a("th",null,"#"),a("th",null,"\u8A02\u55AE\u7DE8\u865F"),a("th",null,"\u8A02\u55AE\u5167\u5BB9"),a("th",null,"\u8A02\u55AE\u5EFA\u7ACB\u6642\u9593"),a("th",null,"\u8A02\u55AE\u72C0\u614B"),a("th",null,"\u4ED8\u6B3E\u72C0\u614B"),a("th",null,"\u51FA\u8CA8\u72C0\u614B"),a("th",null,"\u8A02\u55AE\u91D1\u984D"),a("th",null,"\u8A02\u8CFC\u4EBA"),a("th",null,"\u642D\u8ECA\u91D1\u72C0\u614B")])],-1),we={key:0},Fe=["onClick"],Me={class:"ListOrderNumber"},Le={key:0},ke={key:1},U=20,ze={__name:"orderSearch",setup(xe){const z=te(),n=ae(),R=d([]),w=new Date,k=new Date(new Date().setDate(w.getDate()-7)),I=de(),_=d(!1),H=d(!1),A=d(!1),y=d(1),x=d(0),F=d(0),T=d([]),j=d(""),S=d([]),m=d([]),P=d(!1),$=d(""),e=Y({RegisterPhone:"",OrderNumber:"",StartDate:"",EndDate:"",CustomerName:"",orderStatus:"",DeliveryStatus:"",PaymentStatus:""}),V=Y({RegisterPhone:"",OrderNumber:"",StartDate:"",EndDate:"",CustomerName:"",orderStatus:"",DeliveryStatus:"",PaymentStatus:""});ie(()=>{R.value=[k,w],k.setHours(0,0,0,0),w.setHours(23,59,59,999),e.StartDate=R.value[0],e.EndDate=R.value[1]}),ce(()=>{I.IsLoading=!1});const E=async r=>{if(typeof r!="number"?r=y.value:y.value=r,e.orderStatus){if(e.orderStatus==="\u5168\u90E8")e.orderStatus="";else for(const s in n.OrderStatusMap)if(n.OrderStatusMap[s]===e.orderStatus){e.orderStatus=s;break}}if(e.PaymentStatus){if(e.PaymentStatus==="\u5168\u90E8")e.PaymentStatus="";else for(const s in n.PaymentStatusMap)if(n.PaymentStatusMap[s]===e.PaymentStatus){e.PaymentStatus=s;break}}if(e.DeliveryStatus){if(e.DeliveryStatus==="\u5168\u90E8")e.DeliveryStatus="";else for(const s in n.DeliveryStatusMap)if(n.DeliveryStatusMap[s]===e.DeliveryStatus){e.DeliveryStatus=s;break}}P.value=!0;const o=e.RegisterPhone===""?"":`RegisterPhone=${encodeURIComponent(e.RegisterPhone)}`,l=e.OrderNumber===""?"":`OrderNumber=${encodeURIComponent(e.OrderNumber)}`,h=e.DeliveryStatus===""?"":`DeliveryStatus=${e.DeliveryStatus}`,D=`/Order/Information?${l}&${o}&StartDate=${n.formatDateToYYYYMMDD(e.StartDate)}&EndDate=${n.formatDateToYYYYMMDD(e.EndDate)}&OrderStatus=${e.orderStatus}&${h}&PaymentStatus=${e.PaymentStatus}&Page=${r}&PageSize=20`;try{if(e.StartDate===""&&e.EndDate===""){P.value=!1,I.IsLoading=!1,_.value=!0;return}if(V.RegisterPhone=n.isValidPhone(e.RegisterPhone).errorMessage,!n.isValidPhone(e.RegisterPhone).isValid||!n.isValidDate($.value)){P.value=!1,I.IsLoading=!1,_.value=!0;return}const s=await z.getData(D);if(s.State===0){S.value=[],S.value=s.Data.Data,x.value=s.Data.PageCount,F.value=s.Data.TotalCount;const g=S.value.map(b=>{const M=b.List.length>1,{...t}=b;return{...t,hasList:M}});m.value=g}else S.value=[];P.value=!1,I.IsLoading=!1,_.value=!0}catch(s){console.error("Error sending POST request:",s)}},q=r=>{e.RegisterPhone=r.trim()},J=r=>{e.OrderNumber=r.trim()},K=r=>{$.value=r.value2;const o=new Date(r.value1[0]),l=new Date(r.value1[1]);o.setHours(0,0,0,0),l.setHours(23,59,59,999),e.StartDate=o,e.EndDate=l},Q=r=>{e.orderStatus=r.trim()},W=r=>{e.DeliveryStatus=r.trim()},X=r=>{e.PaymentStatus=r.trim()},Z=(r,o)=>{if(r.showDetails=!r.showDetails,r.showDetails){const l=S.value.find(h=>h.Id===o);if(l){const h=l.List.map((s,g)=>({...s,Id:l.Id,isChild:!0,isFirstChild:g===0,isLastChild:g===l.List.length-1})),D=m.value.findIndex(s=>s.Id===o);D!==-1&&m.value.splice(D+1,0,...h)}}else{const l=m.value.findIndex(h=>h.Id===o);if(l!==-1){const D=m.value.filter(s=>s.Id===o&&s.isChild).length;D>0&&m.value.splice(l+1,D)}}};return(r,o)=>{const l=ue,h=le,D=oe,s=se,g=re,b=ne,M=ee;return i(),c("div",me,[a("div",fe,[a("form",{onSubmit:o[3]||(o[3]=he(t=>E(1),["prevent"]))},[a("div",ge,[a("div",_e,[v(l,{inputType:"text",inputId:"searchForm.OrderNumber",inputName:"searchForm.OrderNumber","data-value":e.OrderNumber,value:e.OrderNumber,isFocused:A.value,label:"\u8A02\u55AE\u7DE8\u865F",tabIndex:1,"onUpdate:modelValue":o[0]||(o[0]=t=>e.OrderNumber=t),onGetReturnData:J},null,8,["data-value","value","isFocused"]),v(l,{inputType:"phone",inputId:"searchForm.RegisterPhone",inputName:"searchForm.RegisterPhone","data-value":e.RegisterPhone,value:e.RegisterPhone,isFocused:H.value,label:"\u8A3B\u518A\u9580\u865F",tabIndex:1,errorMessage:V.RegisterPhone,"onUpdate:modelValue":o[1]||(o[1]=t=>e.RegisterPhone=t),onGetReturnData:q},null,8,["data-value","value","isFocused","errorMessage"])]),a("div",ye,[v(pe,{selectedValue:T.value,"onUpdate:selectedValue":o[2]||(o[2]=t=>T.value=t),datepicketStatus:j.value,label:"\u8A02\u55AE\u5EFA\u7ACB\u6642\u9593 (\u9650\u641C\u5C0B 92 \u5929\u5167\u5340\u9593)",onGetReturnData:K},null,8,["selectedValue","datepicketStatus"])])]),Pe,a("div",be,[a("div",Ie,[a("div",Ce,[v(h,{options:["\u8ACB\u9078\u64C7\u72C0\u614B","\u5168\u90E8","\u8655\u7406\u4E2D","\u5DF2\u522A\u9664","\u5DF2\u78BA\u8A8D","\u5DF2\u5B8C\u6210","\u5DF2\u53D6\u6D88"],inputType:"text",inputId:"searchForm.orderStatus",inputName:"searchForm.orderStatus","data-value":e.orderStatus,value:e.orderStatus,label:"\u8A02\u55AE\u72C0\u614B",disabledChoice:"\u8ACB\u9078\u64C7\u72C0\u614B",errorMessage:"",tabIndex:"1",onGetReturnData:Q},null,8,["data-value","value"]),v(h,{options:["\u8ACB\u9078\u64C7\u72C0\u614B","\u5168\u90E8","\u5099\u8CA8\u4E2D","\u767C\u8CA8\u4E2D","\u5DF2\u767C\u8CA8","\u5DF2\u5230\u9054","\u5DF2\u53D6\u8CA8","\u9000\u8CA8\u4E2D","\u5DF2\u9000\u8CA8"],inputType:"text",inputId:"searchForm.DeliveryStatus",inputName:"searchForm.DeliveryStatus","data-value":e.DeliveryStatus,value:e.DeliveryStatus,label:"\u51FA\u8CA8\u72C0\u614B",disabledChoice:"\u8ACB\u9078\u64C7\u72C0\u614B",errorMessage:"",tabIndex:"1",onGetReturnData:W},null,8,["data-value","value"]),v(h,{options:["\u8ACB\u9078\u64C7\u72C0\u614B","\u5168\u90E8","\u672A\u4ED8\u6B3E","\u5DF2\u4ED8\u6B3E","\u9000\u6B3E\u4E2D","\u5DF2\u9000\u6B3E","\u5DF2\u90E8\u5206\u9000\u6B3E"],inputType:"text",inputId:"searchForm.PaymentStatus",inputName:"searchForm.PaymentStatus","data-value":e.PaymentStatus,value:e.PaymentStatus,label:"\u4ED8\u6B3E\u72C0\u614B",disabledChoice:"\u8ACB\u9078\u64C7\u72C0\u614B",errorMessage:"",tabIndex:"1",onGetReturnData:X},null,8,["data-value","value"])]),v(D,{searchLoading:P.value},null,8,["searchLoading"])])])],32)]),v(M,{searchedData:S.value,notSearchYet:_.value},{content:G(()=>[ve(a("div",Oe,[v(s,{class:"mt-0",currentPage:y.value,pageSize:U,searchedData:S.value,totalCount:F.value},null,8,["currentPage","searchedData","totalCount"]),v(g,null,{default:G(()=>[a("table",Ne,[Re,a("tbody",null,[(i(!0),c(C,null,O(m.value,t=>(i(),c("tr",{key:t.ID,class:N({trIsChild:t.isChild})},[a("td",null,[t.isChild?B("",!0):(i(),c("span",we,u(t.Id),1))]),a("td",null,[a("div",{class:N(["d-flex align-items-center",{trIsFirstChild:t.isFirstChild,trIsLastChild:t.isLastChild,trIsMiddleChild:!t.isFirstChild&&!t.isLastChild}])},[t.hasList?(i(),c("button",{key:0,class:N(["d-flex justify-content-center align-items-center",[{"order-expand-btn":!t.showDetails},{"order-expanded-btn":t.showDetails}]]),onClick:f=>Z(t,t.Id)},[a("i",{class:N([{"bi-plus":!t.showDetails},{"bi bi-dash":t.showDetails},{"rotate-90":!t.showDetails},{"rotate-180":t.showDetails}])},null,2)],10,Fe)):B("",!0),a("div",Me,u(t.OrderNumber?t.OrderNumber:"--"),1)],2)]),a("td",null,u(t.OrderContent?t.OrderContent:"--"),1),a("td",null,u(t.OrderCreateTime?p(n).formatDate(t.OrderCreateTime):"--"),1),a("td",null,u(t.OrderStatus?p(n).OrderStatusMap[t.OrderStatus]:"--"),1),a("td",null,u(t.PaymentStatus?p(n).PaymentStatusMap[t.PaymentStatus]:"--"),1),a("td",null,u(t.DeliveryStatus?p(n).DeliveryStatusMap[t.DeliveryStatus]:"--"),1),a("td",null,u(t.OrderTotalSum?t.OrderTotalSum:"--"),1),a("td",null,u(t.OrderPlacer?t.OrderPlacer:"--"),1),a("td",null,[De(u(t.HasTicket?"":"--")+" ",1),!t.hasList&&t.List&&t.List.length==1&&t.List[0].TicketInsertInfo.length>0?(i(),c("div",Le,[(i(!0),c(C,null,O(t.List,f=>(i(),c("div",{key:f},[(i(!0),c(C,null,O(f.TicketInsertInfo,L=>(i(),c("p",{key:L},u(L.AID)+" / "+u(p(n).TicketStatusMap[p(n).NumericStatusMap[L.Status]]),1))),128))]))),128))])):(i(),c("div",ke,[(i(!0),c(C,null,O(t.TicketInsertInfo,f=>(i(),c("p",{key:f},u(f.AID)+" / "+u(p(n).TicketStatusMap[p(n).NumericStatusMap[f.Status]]),1))),128))]))])],2))),128))])])]),_:1}),v(s,{currentPage:y.value,pageSize:U,searchedData:S.value,totalCount:F.value},null,8,["currentPage","searchedData","totalCount"]),a("div",null,[v(b,{searchFun:E,currentPage:y.value,pageCount:x.value},null,8,["currentPage","pageCount"])])],512),[[Se,S.value.length>0&&_.value]])]),_:1},8,["searchedData","notSearchYet"])])}}};export{ze as default};
