import{a as Z,u as ee,_ as te,b as ae,c as se}from"./globalFunctions.6c536278.js";import{_ as ne}from"./SearchBtn.e8dd1aed.js";import{_ as oe}from"./SelectThreeGroupBox.fa2fa838.js";import{r as o,H as le,k as z,c as f,d as T,e,i as I,K as re,n as F,t as c,h as S,b as ue,D as B,o as ie,C as de,E as ce,M as U,N as Y,f as g,G as A,w as me,F as ve,g as pe,u as L}from"./index.acd8174a.js";import{_ as he}from"./InputTwoGroupBox.b2d0888b.js";/* empty css             */import{_ as ge}from"./CustomDatePicker.vue_vue_type_script_setup_true_lang.2a23c29c.js";const fe={class:"inputThreegroupBox"},De={class:"inputThreegroup d-flex justify-content-between"},_e={class:"d-flex position-relative w-100"},be={class:"group"},Ce=["type","id","name","value","data-value","tabindex"],Ie=["for"],Te={class:"input-group-right d-flex align-items-center"},Me={key:0,class:"d-flex"},Re={class:"error"},Ve={__name:"InputThreeGroupBox",props:["inputType","inputId","inputName","value","label","errorMessage","tabIndex"],emits:["getReturnData"],setup(m,{emit:u}){const D=m,l=o(D.value),M=o(!1),v=le(()=>typeof D.errorMessage>"u"?!1:D.errorMessage!==""),R=()=>{l.value="",C(l.value)};z(()=>D.value,d=>{l.value=d,C(l.value)});const V=d=>{l.value=d.target.value,C(l.value)},C=d=>{u("getReturnData",d)};return(d,r)=>(f(),T("div",fe,[e("div",De,[e("div",_e,[e("div",be,[I(e("input",{type:m.inputType,id:m.inputId,name:m.inputName,value:l.value,"onUpdate:modelValue":r[0]||(r[0]=P=>l.value=P),onInput:V,"data-value":l.value,onFocus:r[1]||(r[1]=P=>M.value=!0),onBlur:r[2]||(r[2]=P=>M.value=!1),tabindex:m.tabIndex,autocomplete:"off",class:F({"error-state":v.value})},null,42,Ce),[[re,l.value]]),e("label",{for:m.inputId},c(m.label),9,Ie)]),e("span",Te,[M.value||typeof l.value<"u"&&l.value!==""?(f(),T("button",{key:0,type:"button",class:"border-0 btn p-0",onClick:R},[e("i",{class:F(["bi bi-x-circle",{"error-state":v.value}])},null,2)])):S("",!0)])])]),v.value?(f(),T("div",Me,[e("span",Re,c(m.errorMessage),1)])):S("",!0)]))}},Pe={class:"memberSearch"},xe={class:"searchSetion"},Se={class:"d-flex col-6"},$e={class:"input-group"},ye={class:"input-group-prepend"},Ne={for:"radio1",class:"d-flex align-items-center"},Ae=e("span",null,"\u9580\u865F",-1),Fe={for:"radio2",class:"d-flex align-items-center"},we=e("span",null,"CAID",-1),ke={class:"col-6"},Ee=e("p",{class:"advancedTitle"},"\u9032\u968E\u641C\u5C0B\u689D\u4EF6",-1),Ge={class:"d-flex"},Be={class:"d-flex w-100 justify-content-between"},Ue={class:"advancedTitle-content d-flex align-items-center"},Ye={class:"searchResult"},Le=e("h4",null,"\u641C\u5C0B\u7D50\u679C",-1),Oe={class:"searchResult-content d-flex justify-content-center align-items-center"},ze={class:"Result"},He={class:"table table-hover m-0"},je=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"\u8A3B\u518A\u9580\u865F"),e("th",null,"\u59D3\u540D"),e("th",null,"\u718A\u7C4D"),e("th",null,"\u7D2F\u7A4D\u8A02\u55AE\u6578"),e("th",null,"\u7D2F\u7A4D\u8A02\u55AE\u91D1\u984D"),e("th",null,"\u8A3B\u518A\u6642\u9593"),e("th",null,"\u6700\u5F8C\u767B\u5165\u6642\u9593")])],-1),qe=e("div",{class:"noResult"},[e("i",{class:"bi bi-file-text-fill custom-icon"}),e("p",null,"\u8ACB\u8F38\u5165\u6216\u8A2D\u5B9A\u9700\u8981\u7684\u689D\u4EF6\u5F8C\u6309\u4E0B\u641C\u5C0B\u6309\u9215"),e("p",null,"\u5C07\u5728\u6B64\u70BA\u60A8\u986F\u793A\u641C\u5C0B\u7D50\u679C")],-1),Ke=[qe],Je=e("div",{class:"noResult"},[e("i",{class:"bi bi-clipboard2-x-fill custom-icon"}),e("p",null,"\u627E\u4E0D\u5230\u7B26\u5408\u689D\u4EF6\u7684\u8CC7\u6599")],-1),Qe=[Je],O=20,nt={__name:"memeberSearch",setup(m){const u=Z(),D=o([]),l=o(""),M=ee(),v=o(1),R=o([]),V=new Date,C=new Date(new Date().setDate(V.getDate()-7)),d=ue(),r=o(!1),P=o(!1),H=o(!1),p=o("phone"),t=B({RegisterPhone:"",CAID:"",StartDate:"",EndDate:"",CustomerName:"",MemberTierValue:""}),_=B({RegisterPhone:"",CAID:"",StartDate:"",EndDate:"",CustomerName:"",MemberTierValue:""}),w=o(0),$=o(0),h=o([]),x=o(!1),k=o("");ie(()=>{R.value=[C,V],C.setHours(0,0,0,0),V.setHours(23,59,59,999),t.StartDate=R.value[0],t.EndDate=R.value[1]}),z(p,s=>{s==="phone"?t.CAID="":s==="caid"&&(t.RegisterPhone="",_.CAID=""),(s==="phone"||s==="caid")&&(_.RegisterPhone="",_.CAID="")}),de(()=>{d.IsLoading=!1});const E=async s=>{if(typeof s!="number"?s=v.value:v.value=s,x.value=!0,t.MemberTierValue){if(t.MemberTierValue==="\u5168\u90E8")t.MemberTierValue="";else for(const i in u.MemberTierValueMap)if(u.MemberTierValueMap[i]===t.MemberTierValue){t.MemberTierValue=i;break}}const n=t.RegisterPhone===""?"":`RegisterPhone=${encodeURIComponent(t.RegisterPhone)}`,b=t.CAID===""?"":`CAID=${encodeURIComponent(t.CAID)}`,y=t.CustomerName===""?"":`CustomerName=${encodeURIComponent(t.CustomerName)}`,N=`/Customer/Information?${n}&${b}&StartDate=${u.formatDateToYYYYMMDD(t.StartDate)}&EndDate=${u.formatDateToYYYYMMDD(t.EndDate)}&${y}&MemberTierValue=${t.MemberTierValue}&Page=${s}&PageSize=20`;try{if(t.RegisterPhone===""&&t.CAID===""&&t.StartDate===""&&t.EndDate===""){x.value=!1,r.value=!0;return}if(_.RegisterPhone=u.isValidPhone(t.RegisterPhone).errorMessage,!u.isValidPhone(t.RegisterPhone).isValid||!u.isValidDate(k.value)){x.value=!1,d.IsLoading=!1,r.value=!0;return}const i=await M.getData(N);i.State===0?(h.value=[],h.value=i.Data.Data,w.value=i.Data.PageCount,$.value=i.Data.TotalCount):h.value=[],r.value=!0,x.value=!1,d.IsLoading=!1}catch(i){console.error("Error sending POST request:",i)}},j=s=>{t.RegisterPhone=s.trim()},q=s=>{t.CAID=s.trim()},K=s=>{k.value=s.value2;const n=new Date(s.value1[0]),b=new Date(s.value1[1]);n.setHours(0,0,0,0),b.setHours(23,59,59,999),t.StartDate=n,t.EndDate=b},J=s=>{t.CustomerName=s.trim()},Q=s=>{t.MemberTierValue=s.trim()};return(s,n)=>{const b=he,y=Ve,N=oe,i=ne,G=te,W=ae,X=se;return f(),T("div",Pe,[e("div",xe,[e("form",{onSubmit:n[6]||(n[6]=ce(a=>E(1),["prevent"]))},[e("div",Se,[e("div",$e,[e("div",ye,[e("span",{class:F(["input-group-text d-flex flex-column align-items-start",{error:_.CAID!==""||_.RegisterPhone!==""}])},[e("label",Ne,[I(e("input",{type:"radio",id:"radio1",name:"radioGroup","onUpdate:modelValue":n[0]||(n[0]=a=>p.value=a),value:"phone"},null,512),[[U,p.value]]),Ae]),e("label",Fe,[I(e("input",{type:"radio",id:"radio2",name:"radioGroup","onUpdate:modelValue":n[1]||(n[1]=a=>p.value=a),value:"caid"},null,512),[[U,p.value]]),we])],2)]),p.value==="phone"?(f(),Y(b,{key:0,inputType:"phone",inputId:"RegisterPhone",inputName:"RegisterPhone","data-value":t.RegisterPhone,value:p.value==="phone"?t.RegisterPhone:"",isFocused:P.value,label:"\u8A3B\u518A\u9580\u865F",tabIndex:1,errorMessage:_.RegisterPhone,"onUpdate:modelValue":n[2]||(n[2]=a=>t.RegisterPhone=a),onGetReturnData:j},null,8,["data-value","value","isFocused","errorMessage"])):S("",!0),p.value==="caid"?(f(),Y(b,{key:1,inputType:"number",inputId:"CAID",inputName:"CAID","data-value":t.CAID,value:p.value==="caid"?t.CAID:"",isFocused:H.value,label:"CAID",tabIndex:1,"onUpdate:modelValue":n[3]||(n[3]=a=>t.CAID=a),onGetReturnData:q},null,8,["data-value","value","isFocused"])):S("",!0)]),e("div",ke,[g(ge,{label:"\u8A3B\u518A\u6642\u9593 (\u9650\u641C\u5C0B 92 \u5929\u5167\u5340\u9593)",selectedValue:D.value,"onUpdate:selectedValue":n[4]||(n[4]=a=>D.value=a),datepicketStatus:l.value,onGetReturnData:K},null,8,["selectedValue","datepicketStatus"])])]),Ee,e("div",Ge,[e("div",Be,[e("div",Ue,[g(y,{inputType:"text",inputId:"searchForm.CustomerName",inputName:"searchForm.CustomerName","data-value":t.CustomerName,value:t.CustomerName,isFocused:s.isCustomerNameFocused,label:"\u6703\u54E1\u59D3\u540D",tabIndex:1,"onUpdate:modelValue":n[5]||(n[5]=a=>t.CustomerName=a),onGetReturnData:J},null,8,["data-value","value","isFocused"]),g(N,{options:["\u8ACB\u9078\u64C7\u6703\u54E1\u7B49\u7D1A","\u5168\u90E8","\u5C0F\u718A","\u9ED1\u718A","\u9280\u718A","\u91D1\u718A","\u947D\u77F3\u718A"],inputType:"text",inputId:"searchForm.MemberTierValue",inputName:"searchForm.MemberTierValue","data-value":t.MemberTierValue,value:t.MemberTierValue,label:"\u718A\u7C4D",disabledChoice:"\u8ACB\u9078\u64C7\u6703\u54E1\u7B49\u7D1A",errorMessage:"",tabIndex:"1",onGetReturnData:Q},null,8,["data-value","value"])]),g(i,{searchLoading:x.value},null,8,["searchLoading"])])])],32)]),e("div",Ye,[Le,e("div",Oe,[I(e("div",ze,[g(G,{class:"mt-0",currentPage:v.value,pageSize:O,searchedData:h.value,totalCount:$.value},null,8,["currentPage","searchedData","totalCount"]),g(W,null,{default:me(()=>[e("table",He,[je,e("tbody",null,[(f(!0),T(ve,null,pe(h.value,a=>(f(),T("tr",{key:a.CAID,class:""},[e("td",null,c(a.Id),1),e("td",null,c(a.RegisterPhone?a.RegisterPhone:"--"),1),e("td",null,c(a.Name?a.Name:"--"),1),e("td",null,c(a.MemberTierValue?L(u).MemberTierValueMap[a.MemberTierValue]:"--"),1),e("td",null,c(a.OrderCount?a.OrderCount:"0"),1),e("td",null,c(a.OrdersTotalSum?a.OrdersTotalSum:"--"),1),e("td",null,c(a.RegisterTime?L(u).formatDate(a.RegisterTime):"--"),1),e("td",null,c(a.\u6700\u5F8C\u767B\u5165\u6642\u9593?a.\u6700\u5F8C\u767B\u5165\u6642\u9593:"--"),1)]))),128))])])]),_:1}),g(G,{currentPage:v.value,pageSize:O,searchedData:h.value,totalCount:$.value},null,8,["currentPage","searchedData","totalCount"]),e("div",null,[g(X,{searchFun:E,currentPage:v.value,pageCount:w.value},null,8,["currentPage","pageCount"])])],512),[[A,h.value.length>0&&r.value]]),I(e("div",null,Ke,512),[[A,!r.value]]),I(e("div",null,Qe,512),[[A,h.value.length==0&&r.value]])])])])}}};export{nt as default};
